# 计算机基础

### 1、TCP如何实现可靠传输

- 应用数据被分割成TCP认为最适合发送的数据块
- 超时重传：当tcp发送一个段后，它启动了一个定时器，等待目的端确认收到这个报文段，如果不能及时收到一个确认，将重发这个报文段。
- TCP给发送的每一个包进行编号，接收方对数据包进行排序，把有序数据传送给应用层。
- 校验和：TCP将保持它首部和数据的校验和，这是一个端到端的校验和，目的是检测数据在传输过程中的任何变化，如果收到段的校验和有差错，TCP将丢弃这个报文段和不确认收到此报文段。
- TCP接收端会丢弃重复的数据。
- 流量控制：TCP链接的每一方都有固定大小的缓冲空间，TCP的接收端只允许发送段发送接收端缓冲区能接纳的数据，当接收方来不及处理发送方的数据，能提示发送方降低发送的速率，防止包丢失。TCP使用的流量控制协议是可变大小的华东窗口协议。
- 拥塞控制：当网络拥塞时，减少数据的发送。

### 2、进程跟线程的联系和区分

- 区别与联系
  - 线程是CPU调度的基本单位，同一个进程中可以有多个线程，但至少有一个线程
  - 进程是操作系统分配资源的最小单位
- 一个进程中有哪些数据段
  - 代码段：保存代码
  - 静态数据段：静态数据
  - 未初始化数据段
  - 栈： 向下增长
  - 堆：向上增长
  - .rodata
- 进程中的不同线程间有哪些数据段是共享的
  - 除了栈之外均可共享

### 3、HTTPS密钥的交换过程

- 使用 **非对称加密** 处理用于加密数据的密钥
- 使用 **对称加密** 处理具体的数据

<img src="../typora-user-images/image-20230404091925444.png" alt="image-20230404091925444" style="zoom: 80%;" />

```
1.客户端获取公钥
	客户端发送请求，服务端返回公钥
	客户端用证书验证公钥，如果合法，继续下一步
2.客户端生成用于加密数据的密钥
	客户端生成随机密钥
	然后用服务器返回的公钥对这个密钥加密，得到加密后的密钥
3.服务端验证密钥
	客户端将加密后的密钥发给服务端
	服务端使用私钥解密得到密钥
4.使用密钥加密数据进行传输，使用密钥解密数据得到明文
	服务端使用获得的密钥加密数据，发送给客户端
	客户端使用密钥解密得到明文。
```

### 4、进程通信的几种方式

- 匿名管道( pipe )：管道是一种半双工的通信方式，数据只能单向流动，而且只能在具有亲缘关系的进程间使用。进程的亲缘关系通常是指父子进程关系。

  ```
  通过匿名管道实现进程间通信的步骤如下：
  父进程创建管道，得到两个⽂件描述符指向管道的两端
  父进程fork出子进程，⼦进程也有两个⽂件描述符指向同⼀管道。
  父进程关闭fd[0],子进程关闭fd[1]，即⽗进程关闭管道读端,⼦进程关闭管道写端（因为管道只支持单向通信）。⽗进程可以往管道⾥写,⼦进程可以从管道⾥读,管道是⽤环形队列实现的,数据从写端流⼊从读端流出,这样就实现了进程间通信。
  ```

- 高级管道(popen)：将另一个程序当做一个新的进程在当前程序进程中启动，则它算是当前程序的子进程，这种方式我们成为高级管道方式。

- 命名管道 (named pipe) ： 命名管道也是半双工的通信方式，但是它允许无亲缘关系进程间的通信。

- 消息队列( message queue ) ： 消息队列是由消息的链表，存放在内核中并由消息队列标识符标识。消息队列克服了信号传递信息少、管道只能承载无格式字节流以及缓冲区大小受限等缺点。

- 信号量( semophore ) ： 信号量是一个计数器，可以用来控制多个进程对共享资源的访问。它常作为一种锁机制，防止某进程正在访问共享资源时，其他进程也访问该资源。因此，主要作为进程间以及同一进程内不同线程之间的同步手段。

- 信号 ( sinal ) ： 信号是一种比较复杂的通信方式，用于通知接收进程某个事件已经发生。

- 共享内存( shared memory ) ：共享内存就是映射一段能被其他进程所访问的内存，这段共享内存由一个进程创建，但多个进程都可以访问。共享内存是最快的 IPC 方式，它是针对其他进程间通信方式运行效率低而专门设计的。它往往与其他通信机制，如信号两，配合使用，来实现进程间的同步和通信。

- 套接字( socket ) ： 套接口也是一种进程间通信机制，与其他通信机制不同的是，它可用于不同机器间的进程通信。

### 5、TCP四次挥手为什么要有TIME_WAIT状态

![image-20230404094211104](../typora-user-images/image-20230404094211104.png)

- 保证TCP协议全双工连接能够可靠关闭，直接关闭的话，如果服务器没有收到ACK，会重复发FIN
- 保证这次连接的重复数据从网络中消失，如果上次的socket和这次的socket处理的程序一样，就会导致这次连接把上次的数据加进来了。