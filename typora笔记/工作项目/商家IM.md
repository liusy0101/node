<!-- vscode-markdown-toc -->
* 1. [业务定位](#)
* 2. [业务场景](#-1)
	* 2.1. [商家被动接待](#-1)
	* 2.2. [商家主动触达](#-1)
* 3. [领域模型](#-1)
	* 3.1. [架构分层](#-1)

<!-- vscode-markdown-toc-config
	numbering=true
	autoSave=true
	/vscode-markdown-toc-config -->
<!-- /vscode-markdown-toc -->
# 商家IM（字节）

##  1. <a name=''></a>业务定位
为国际化电商提供通用客服能力与通道能力服务于商家客服，达人，会员，营销，物流等团队

- 为海外电商提供消息平台能力，支持基于IM通道用卡片，文本，图片，视频的方式触达用户，目前已为CRM团队
提供能力复用
- 为海外电商团队提供基础沟通工具复用，支持基于以群为单位的沟通场景实现能力复用，目前己为商达沟通场景
提供能力复用，最近正在支持达人客服场景以及商家与服务商的沟通
- 为海外电商团队提供通道能力复用，支持邮件等关键通道能力复用


##  2. <a name='-1'></a>业务场景
###  2.1. <a name='-1'></a>商家被动接待

- 售前阶段消费者通过商品详情页（商详页）店铺页主动联系与商家进行咨询，对商品以及商家活动优惠等进行咨询
- 售中与售后阶段消费者通过物流页面，订单页对商家发起咨询，该场最主要涉及到退货退款，物流咨询等问题
- 消费者发起咨询后，初期会有智能客服进行接待，同时会触发排队与分配逻辑将消费者按一定均衡调度策路分配到客服头上
- 系统会搜集客服的按待过程的细节并且计算出其24小时回复率与满惹率透出到治理与客服主管侧，让平台考核商家，商家考核客服，压力层层传递，促使客服提高响应速度与质量

###  2.2. <a name='-1'></a>商家主动触达
商家只允许通过订单、客服后台页面对三天内用户主动发起咨询的用户进行触达


##  3. <a name='-1'></a>领域模型

![](typora-user-images/2023-10-12-16-35-01.png)

![](typora-user-images/2023-10-12-16-36-24.png)

![](typora-user-images/2023-10-12-16-36-54.png)

###  3.1. <a name='-1'></a>架构分层

#### 领域基础层：能力标准化，逻辑趋于稳定

基于领域实体提供稳定的基础能力，并提供租户无关的原子接口


##### 聊天基础域
负责底层通讯能力的实现，其中包含
- IM通道能力
- 邮件通道能力
- 开放平台通道能力
- 商线通道能力
- 触达能力

`职责：`

- 负责消息群整个周期与数据的维护
- 负责聊天消息的收发能力实现与消息类型的整体把控与统筹
- 会话成员管理，包含但不限于权限
- im通道与邮件通道的管理与维护


##### 会话基础域
- 负责会话生命周期一切行为的管理与维护包括但不限于：
会话创建，分配，消亡
- 负责会话信息管理能力

`职责：`

- 会话列表的维护与更新通知
- 发送对应领域事件
- 基础会话状态的维护，创建、状态流转、过期消亡、评价、留言

##### 用户域
负责一切用户相关的数据生命周期维护包括但不限于账号映射，流量调度，上线通知等能力

`职责：`

- 完成用户数据的生命周期管理包括但不限于创建/注销用户数据，维护用戸信息
- 完成用户请求基础鉴权与角色管理
- 负责用户登陆状态的维护与流量的调度


##### 信息检索域
负责IM系统一切消息，会话，配置等数据搜索能力建设

`职责：`

- 消息检索
- 会话检索
- 配置检索
- 订单检索

#### 公共业务层：可复用，支持业务差异化
- 提供主要业务场景服务，包括如支持不同租户问的接待流程编排与分配流程编排
- 聚合领域基础能力，构建业务上可复用的策略能力，通过配置、编排等形式快速为业务提供复用

##### IM触达域
负责消息离线触达、邮件触达、长链触达等能力集合

提供通用的触达能力

##### 会话调度域

- 负责会话相关数据的统计与透出包括如：接待数据统计，客服考核．店铺考核
- 负责排队与客服分配调度能力实现

`职责：`

- 会话排队
- 会话分配
- 在线队列、离线队列、留言队列的数据流转

##### 辅助接待域
- 负责由消息触发作为源头的处理场景（会话相关除外）
- 负责接待与触达强相关场景包括但不限于智能机器人、自动接待
- 作为数据开放网关，将整个IM系统的消息，会话等数据与能力开放到第三方系统

`职责：`

- 消费IMCloud的在线消息记录、商线消息推送
- 对买家消息进行自动回复 （FAQ、全自动机器人、辅助回复、非工作时间自动回复）
- 消息触达
  - Ann Puch 、邮件、 IMCloud 、 Frontier
- 作为数据网关开放IM系统的会话能力，消息能力与业务能力

![](typora-user-images/2023-10-12-17-04-51.png)

![](typora-user-images/2023-10-12-17-06-03.png)



